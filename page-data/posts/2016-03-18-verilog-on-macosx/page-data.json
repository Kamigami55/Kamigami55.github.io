{"componentChunkName":"component---src-templates-post-template-js","path":"/posts/2016-03-18-verilog-on-macosx/","result":{"data":{"markdownRemark":{"id":"72f0c9f8-b811-588d-a8cb-a088b91383b1","html":"<blockquote>\n<p>一句話摘要：使用Icarus Verilog來編譯Verilog、使用GTKWave來顯示波形</p>\n</blockquote>\n<p>為了資工系的數位電路設計課，我們需要一個能夠編譯Verilog這個硬體描述語言(HDL)的環境，並且要能模擬電路運作狀況加上顯示波形。</p>\n<!-- more -->\n<p>老師建議的編譯環境是<a href=\"https://www.mentor.com/products/fpga/model/\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">ModelSim</a>，但是它只支援Windows，我目前還沒找到Mac OS X或是Linux的版本，所以我只好另尋他法，找看看有沒有其他能夠編譯Verilog的工具。</p>\n<p>我找到了<a href=\"http://iverilog.icarus.com/home\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">Icarus Verilog</a>，它是針對Linux的Verilog編譯器，而在Mac OS X底下，我們可以藉由Command Line來使用它。</p>\n<h1 id=\"安裝icarus-verilog\" style=\"position:relative;\"><a href=\"#%E5%AE%89%E8%A3%9Dicarus-verilog\" aria-label=\"安裝icarus verilog permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>安裝Icarus Verilog</h1>\n<p>這是<a href=\"http://iverilog.wikia.com/wiki/Installation_Guide\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">Icarus Verilog的安裝指南</a>，很完整的說明了怎麼在各種作業系統上安裝它，不過是英文的，而且字有點多。</p>\n<p>對於Mac OS X你有兩種安裝手段，編譯程式原始碼來安裝，或是透過套件管理系統安裝，對於我這種懶人來說，當然是選擇使用套件管理系統囉！</p>\n<p>我使用<a href=\"http://brew.sh/index_zh-tw.html\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">Homebrew</a>來安裝Icarus Verilog，如果你還沒有安裝Homebrew，去把它裝起來吧！身為一位Mac用戶兼資工系學生，Homebrew必備呀！</p>\n<p>你可以在你的Command Line裡輸入這段文字來安裝Homebrew（請忽略最左方的$符號，這是Command Line的提示字元）：</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">$ /usr/bin/ruby -e &quot;$(curl -fsSL https://raw.githubusercontent.com/Homebrew/install/master/install)&quot;</code></pre></div>\n<p>接著使用這段homebrew的指令來安裝Icarus Verilog：</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">$ brew install icarus-verilog</code></pre></div>\n<p>OK！現在你已經成功安裝了Icarus Verilog了！Homebrew就是這麼的神奇！</p>\n<h1 id=\"測試icarus-verilog\" style=\"position:relative;\"><a href=\"#%E6%B8%AC%E8%A9%A6icarus-verilog\" aria-label=\"測試icarus verilog permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>測試Icarus Verilog</h1>\n<p>安裝完了一個新程式，當然是要測試一下它的功能正不正常呀，這時就輪到經典Hello World測試程式登場了！</p>\n<p>首先建立一個新文件命名為hello.v，內含以下內容（Verilog的源碼檔副檔名為.v）：</p>\n<div class=\"gatsby-highlight\" data-language=\"veriloghello.v\"><pre class=\"language-veriloghello.v\"><code class=\"language-veriloghello.v\">module main;\n  initial \n    begin\n      $display(&quot;Hello, World&quot;);\n      $finish ;\n    end\nendmodule</code></pre></div>\n<p>接著使用iverilog指令來編譯hello.v，使用-o hello來指定以hello來作為產生的可執行檔檔名：</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">$ iverilog -o hello hello.v</code></pre></div>\n<p>最後，使用vvp指令來執行hello這個可執行檔，只要你看到Hello, World這個輸出，就代表你的Icarus Verilog安裝成功了：</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">$ vvp hello\nHello, World</code></pre></div>\n<h1 id=\"安裝gtkwave\" style=\"position:relative;\"><a href=\"#%E5%AE%89%E8%A3%9Dgtkwave\" aria-label=\"安裝gtkwave permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>安裝GTKWave</h1>\n<p>接著，為了能夠更方便地查看電路運作的狀況，你需要一個波型顯示軟體，我使用<a href=\"http://gtkwave.sourceforge.net\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">GTKWave</a>，這是一個可以跑在Mac OS X、Linux、和Windows上的波型顯示軟體，使用效果如下圖（截圖自官網）：</p>\n<p><img src=\"https://i.imgur.com/qRG7zAU.jpg\" alt=\"13010278_1324168817596781_1227376771_o.png\"></p>\n<p>要在Mac OS X上安裝它很容易，就跟你安裝其他應用程式一樣，最大的困難可能是在官網上找到正確的下載連結…，連結已經幫你標出來了，請在官網上找到上圖紅框處download連結把它點下去！</p>\n<p>接著把載下來了.zip檔解壓縮，完畢後得到的.app檔就是你要的GTKWave了！隨點隨用免安裝，那～麼～厲害！</p>\n<h1 id=\"使用gtkwave來顯示波形\" style=\"position:relative;\"><a href=\"#%E4%BD%BF%E7%94%A8gtkwave%E4%BE%86%E9%A1%AF%E7%A4%BA%E6%B3%A2%E5%BD%A2\" aria-label=\"使用gtkwave來顯示波形 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>使用GTKWave來顯示波形</h1>\n<h2 id=\"建立新的測試程式\" style=\"position:relative;\"><a href=\"#%E5%BB%BA%E7%AB%8B%E6%96%B0%E7%9A%84%E6%B8%AC%E8%A9%A6%E7%A8%8B%E5%BC%8F\" aria-label=\"建立新的測試程式 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>建立新的測試程式</h2>\n<p>先別急著打開你的GTKWave，你還需要一個新的測試程式，之前的hello world程式可根本不算是一個電路呢！</p>\n<p>首先建立兩個新檔案，命名為Simple<em>Circuit.v和t</em>Simple_Circuit.v（修改自我們老師的Lab0範例）：</p>\n<div class=\"gatsby-highlight\" data-language=\"verilogsimple_circuit.v\"><pre class=\"language-verilogsimple_circuit.v\"><code class=\"language-verilogsimple_circuit.v\">module\tSimple_Circuit(A, B, C, D, E);\n  output\tD, E;\n  input\tA, B, C;\n  wire\tw1;\n\t\n\tand\t\tG1(w1, A, B);\n\tnot\t\tG2(E, C);\n\tor\t\tG3(D, w1, E);\nendmodule</code></pre></div>\n<div class=\"gatsby-highlight\" data-language=\"verilogt_simple_circuit.v\"><pre class=\"language-verilogt_simple_circuit.v\"><code class=\"language-verilogt_simple_circuit.v\">module\tt_Simple_Circuit;\n  wire\tD, E;\n  reg\t\tA, B, C;\n\t\n  //instantiate device under test\n  Simple_Circuit\tM1(A, B, C, D, E);\n\t\n  //apply inputs one at a time\n  initial\tbegin\n    $dumpfile(&quot;mytest.vcd&quot;);\n    $dumpvars;\n    A=1&#39;b0; B=1&#39;b0; C=1&#39;b0;\n    #100 A=1&#39;b1; B=1&#39;b1; C=1&#39;b1; \n  end\n  \n  initial #200 $finish;\nendmodule</code></pre></div>\n<p>將這兩個檔案編譯為mycircuit這個執行檔，並且執行它：</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">$ iverilog -o mycircuit t_Simple_Circuit.v Simple_Circuit.v\n$ vvp mycircuit</code></pre></div>\n<p>因為我們在t<em>Simple</em>Circuit.v這個電路測試檔案裡頭加入了dumpfile和dumpvars，所以執行完mycircuit後，會產生一個名為mytest.vcd的檔案，裡頭包含了我們所要的波型紀錄。</p>\n<p>現在我們可以使用GTKWave來檢視波型了！</p>\n<h2 id=\"正式開啟gtkwave來檢視波型\" style=\"position:relative;\"><a href=\"#%E6%AD%A3%E5%BC%8F%E9%96%8B%E5%95%9Fgtkwave%E4%BE%86%E6%AA%A2%E8%A6%96%E6%B3%A2%E5%9E%8B\" aria-label=\"正式開啟gtkwave來檢視波型 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>正式開啟GTKWave來檢視波型</h2>\n<p>開啟你的GTKWave，點擊左上角的File > Open New Tab\n選擇剛剛產生的mytest.vcd檔，你應該會很失望地發現為什麼沒有出現你要的波型，如下圖：</p>\n<p><img src=\"https://i.imgur.com/RJIQuvS.jpg\" alt=\"螢幕快照 2016-03-19 上午1.23.20.png\"></p>\n<p>那是因為你還沒有告訴GTKWave你想要看什麼，那我們就來告訴它吧！</p>\n<p>在GTKWave左側面板，你會看到一串文字寫著t<em>Simple</em>Circuit，那就是你的測試檔案，點開那個+號，點擊M1電路，下面就會列出M1電路裡所有的線路，把你想要看它波形的線路拖曳到右方的區塊吧！噠答！你要的波型顯示出來了！</p>\n<p><img src=\"https://i.imgur.com/86eXv9b.jpg\" alt=\"螢幕快照 2016-03-19 上午1.30.18.png\"></p>\n<p>恭喜你成功建置你的Verilog環境，現在你可以炫砲地使用你的Macbook來做數電設計作業了！</p>\n<h1 id=\"指令小筆記\" style=\"position:relative;\"><a href=\"#%E6%8C%87%E4%BB%A4%E5%B0%8F%E7%AD%86%E8%A8%98\" aria-label=\"指令小筆記 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>指令小筆記</h1>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">$ iverilog -o &lt;output-file&gt; &lt;source-file-1&gt; &lt;source-file-2&gt; ... // 編譯\n$ vvp &lt;executable-verilog-file&gt; // 執行</code></pre></div>","fields":{"slug":"/posts/2016-03-18-verilog-on-macosx/","tagSlugs":["/tag/verilog/","/tag/tutorial/","/tag/mac-osx/","/tag/i-verilog/","/tag/hdl/","/tag/tutorial/"]},"frontmatter":{"date":"2016-03-18 17:40","description":"","tags":["Verilog","Tutorial","MacOSX","iVerilog","HDL","Tutorial"],"title":"如何在Mac OS X上安裝Verilog環境","socialImage":"https://i.imgur.com/5qKcx3Q.jpg"}}},"pageContext":{"slug":"/posts/2016-03-18-verilog-on-macosx/"}},"staticQueryHashes":["251939775","401334301","825871152"]}